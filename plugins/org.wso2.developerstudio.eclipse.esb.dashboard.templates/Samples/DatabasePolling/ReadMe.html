<!DOCTYPE html>
<html>
<title>Database Polling Sample</title>
<head>
</head>
<body>
	<div id="content">
		<h1>Database Polling Sample</h1>
		<h3>About the Sample</h3>
		<p>
			<span style="font-weight: 400;">This sample demonstrates data
				polling capability in Enterprise Integrator.</span>
		</p>
		<p>
			<span style="font-weight: 400;">Three projects get created
				with this template. </span><strong>ESB Config Project</strong><span
				style="font-weight: 400;"> contains a </span><a
				href="https://docs.wso2.com/display/EI630/Working+with+Scheduled+Tasks"><span
				style="font-weight: 400;">Scheduled Task</span></a><span
				style="font-weight: 400;"> called
				&lsquo;DoctorsRecordsSyncTask&rsquo;, a </span><a
				href="https://docs.wso2.com/display/EI630/Mediation+Sequences"><span
				style="font-weight: 400;">Sequence</span></a><span
				style="font-weight: 400;"> called
				&lsquo;DoctorsRecordsSyncSeq&rsquo; and an </span><a
				href="https://docs.wso2.com/display/EI630/Working+with+Endpoints"><span
				style="font-weight: 400;">Endpoint</span></a><span
				style="font-weight: 400;"> called
				&lsquo;DoctorsDataServiceEP&rsquo;. The data service project expose
				three database operations; &lsquo;ReadDoctors&rsquo;,
				&lsquo;UpdateDoctorsSyncStatus&rsquo; and ReadDoctorsNotSync. The </span><strong>Composite
				Application Project</strong><span style="font-weight: 400;"> is used
				to package and export the artifacts created within the ESB and data
				service projects.</span>
		</p>
		<p>
			<span style="font-weight: 400;">The scheduled task runs
				periodically and injects a dummy payload to the sequence to initiate
				messaging flow. First payload is constructed to invoke data service
				operation &lsquo;ReadDoctors&rsquo; and retrieve doctors record that
				are not synchronized. The second payload is constructed to update
				the not synchronized doctors records as a transaction. There is a
				special type of operation called </span><strong>request_box</strong><span
				style="font-weight: 400;"> in the data service. The
				ReadDoctorsNotSync and UpdateDoctorsSyncStatus operations are
				wrapped with the request_box in order to run them in transactional
				manner. </span>
		</p>
		<h3>Next Steps</h3>
		<p>
			<span style="font-weight: 400;">Setup database and insert some
				bogus records</span>
		</p>
		<p>
			<span style="font-weight: 400;">CREATE TABLE `doctors` (</span>
		</p>
		<p>
			<span style="font-weight: 400;"> &nbsp;`id` int(10) unsigned
				NOT NULL AUTO_INCREMENT,</span>
		</p>
		<p>
			<span style="font-weight: 400;"> &nbsp;`name` varchar(50)
				DEFAULT NULL,</span>
		</p>
		<p>
			<span style="font-weight: 400;"> &nbsp;`hospital` varchar(50)
				DEFAULT NULL,</span>
		</p>
		<p>
			<span style="font-weight: 400;"> &nbsp;`speciality`
				varchar(50) DEFAULT NULL,</span>
		</p>
		<p>
			<span style="font-weight: 400;"> &nbsp;`availability`
				varchar(50) DEFAULT NULL,</span>
		</p>
		<p>
			<span style="font-weight: 400;"> &nbsp;`charge` int(10)
				DEFAULT NULL,</span>
		</p>
		<p>
			<span style="font-weight: 400;"> &nbsp;`sync` int(11) DEFAULT
				'0',</span>
		</p>
		<p>
			<span style="font-weight: 400;"> &nbsp;PRIMARY KEY (`id`)</span>
		</p>
		<p>
			<span style="font-weight: 400;">)</span>
		</p>
		<p>
			<span style="font-weight: 400;">INSERT INTO doctors (name,
				hospital, speciality, availability, charge) values</span>
		</p>
		<p>
			<span style="font-weight: 400;">('thomas collins', 'grand oak
				community hospital', 'surgery', '9.00 a.m - 11.00 a.m', 7000),</span>
		</p>
		<p>
			<span style="font-weight: 400;">('henry parker', 'grand oak
				community hospital', ' ent', '9.00 a.m - 11.00 a.m', 4500),</span>
		</p>
		<p>
			<span style="font-weight: 400;">('abner jones', 'grand oak
				community hospital', 'gynaecology', '8.00 a.m - 10.00 a.m', 11000),</span>
		</p>
		<p>
			<span style="font-weight: 400;">('abner jones', 'grand oak
				community hospital', 'ent', '8.00 a.m - 10.00 a.m', 6750),</span>
		</p>
		<p>
			<span style="font-weight: 400;">('anne clement', 'clemency
				medical center', 'surgery', '8.00 a.m - 10.00 a.m', 12000),</span>
		</p>
		<p>
			<span style="font-weight: 400;">('thomas kirk', 'clemency
				medical center', 'gynaecology', '9.00 a.m - 11.00 a.m', 8000),</span>
		</p>
		<p>
			<span style="font-weight: 400;">('cailen cooper', 'clemency
				medical center', 'paediatric', '9.00 a.m - 11.00 a.m', 5500),</span>
		</p>
		<p>
			<span style="font-weight: 400;">('seth mears', 'pine valley
				community hospital', 'surgery', '3.00 p.m - 5.00 p.m', 8000),</span>
		</p>
		<p>
			<span style="font-weight: 400;">('emeline fulton', 'pine
				valley community hospital', 'cardiology', '8.00 a.m - 10.00 a.m',
				4000),</span>
		</p>
		<p>
			<span style="font-weight: 400;">('jared morris', 'willow
				gardens general hospital', 'cardiology', '9.00 a.m - 11.00 a.m',
				10000),</span>
		</p>
		<p>
			<span style="font-weight: 400;">('henry foster', 'willow
				gardens general hospital', 'paediatric', '8.00 a.m - 10.00 a.m',
				10000),</span>
		</p>
		<p>
			<span style="font-weight: 400;">('chris brown', 'pine valley
				community hospital', 'surgery', '9.00 a.m - 11.00 a.m', 5500),</span>
		</p>
		<p>
			<span style="font-weight: 400;">('victor ivan', 'pine valley
				community hospital', 'ent', '9.00 a.m - 11.00 a.m', 5500),</span>
		</p>
		<p>
			<span style="font-weight: 400;">('jimmy carter', 'willow
				gardens general hospital', 'ent', '9.00 a.m - 11.00 a.m', 2500),</span>
		</p>
		<p>
			<span style="font-weight: 400;">('peter simon', 'clemency
				medical center', 'cardiology', '9.00 a.m - 11.00 a.m', 6000);</span>
		</p>
		<p>
			<span style="font-weight: 400;">Update database URL and
				credentials in the DoctorsDataService.dbs file.</span>
		</p>
		<h3>Executing the sample</h3>
		<ol>
			<li><span style="font-weight: 400;"> Configure EI server</span></li>
		</ol>
		<p>
			<span style="font-weight: 400;">Attach an EI server runtime
				into the Developer Studio following the instructions given below (if
				you haven&rsquo;t already done).</span>
		</p>
		<p>
			<span style="font-weight: 400;">Navigate to the Developer
				Studio Dashboard and click </span><strong>Server</strong><span
				style="font-weight: 400;"> under </span><strong>Add Server</strong><span
				style="font-weight: 400;">.</span>
		</p>
		<p>
			<span style="font-weight: 400;">In the &lsquo;</span><strong>Define
				a New Server</strong><span style="font-weight: 400;">&rsquo; dialog
				box, expand the WSO2 folder, and select the respective product and
				version.</span>
		</p>
		<p>
			<span style="font-weight: 400;">Click </span><strong>Next</strong><span
				style="font-weight: 400;">, click </span><strong>Browse</strong><span
				style="font-weight: 400;"> that is next to CARBON_HOME, and
				select the WSO2 EI distribution directory, to define the server
				runtime environment and click </span><strong>Next</strong><span
				style="font-weight: 400;">.</span>
		</p>
		<p>
			<span style="font-weight: 400;">Review the default port
				details for the ESB profile of WSO2 EI. Typically, you can leave
				these unchanged, but if you are already running another server on
				these ports, specify unused ports here. (See </span><a
				href="https://docs.wso2.com/display/ADMIN44x/Default+Ports+of+WSO2+Products"><span
				style="font-weight: 400;">Default Ports of WSO2 Products</span></a><span
				style="font-weight: 400;"> for more information.) Click </span><strong>Next</strong><span
				style="font-weight: 400;">. </span>
		</p>
		<ol start="2">
			<li><span style="font-weight: 400;"> Deploy the CApp
					project.</span></li>
		</ol>
		<p>
			<span style="font-weight: 400;">To deploy the CApp project in
				the ESB server that we just added, select relevant project from the
				list, click </span><strong>Add</strong><span style="font-weight: 400;">
				to move it into the Configured list, and then click </span><strong>Finish</strong><span
				style="font-weight: 400;">.</span>
		</p>
		<p>
			<span style="font-weight: 400;">Please refer to </span><a
				href="https://docs.wso2.com/display/ADMIN44x/Deploying+Composite+Applications+in+the+Server#DeployingCompositeApplicationsintheServer-DeployingusingtheToolinginterface"><span
				style="font-weight: 400;">this resource</span></a><span
				style="font-weight: 400;"> for more information.</span>
		</p>
		<p>
			<span style="font-weight: 400;">The ESB server of WSO2 EI is
				now added inside Eclipse tooling.</span>
		</p>
		<ol start="3">
			<li><span style="font-weight: 400;"> Start the server</span></li>
		</ol>
		<p>
			<span style="font-weight: 400;">You will see that the server
				is currently stopped. Click </span><strong>Play </strong><span
				style="font-weight: 400;">butto</span><strong>n </strong><span
				style="font-weight: 400;">on the toolbar to start the server.
			</span>
		</p>
		<p>
			<span style="font-weight: 400;">If you are prompted to save
				changes to any of the artifact files, click </span><strong>Yes</strong><span
				style="font-weight: 400;">. </span>
		</p>
		<p>
			<span style="font-weight: 400;">As the server starts, the
				Console tab will appear. You should see messages indicating that the
				C-App was successfully deployed. The C-App will now be available in
				the ESB profile's management console (</span><strong>Manage -&gt;
				Carbon Applications -&gt; List</strong><span style="font-weight: 400;">).</span>
		</p>
		<ol start="4">
			<li><span style="font-weight: 400;"> Invoke the service</span></li>
		</ol>
		<p>
			<span style="font-weight: 400;">Schedule task is executed
				after you deploy the carbon application.</span>
		</p>
	</div>
</body>
</html>
